
-- Power BI Measures (paste into a Measures table)

Customers := DISTINCTCOUNT('fact_customer_snapshot'[customer_id])
Churned Customers := CALCULATE([Customers], 'fact_customer_snapshot'[churn_flag] = 1)
Churn Rate := DIVIDE([Churned Customers], [Customers])
New Customers Last Quarter := CALCULATE([Customers], 'fact_customer_snapshot'[new_last_quarter] = 1)
High-Value Customers := CALCULATE([Customers], 'fact_customer_snapshot'[high_value] = 1)
High-Value Churn Rate :=
DIVIDE(
    CALCULATE([Customers], 'fact_customer_snapshot'[churn_flag] = 1, 'fact_customer_snapshot'[high_value] = 1),
    [High-Value Customers]
)

-- Example slicer-friendly measures
Monthly Charge (Median) := MEDIAN('fact_customer_snapshot'[monthly_charge])
Tenure (Median) := MEDIAN('fact_customer_snapshot'[tenure_in_months])
